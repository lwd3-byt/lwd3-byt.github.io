

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="lwd">
  <meta name="keywords" content="">
  
  <title>spring-boot-starter-security：应用安全 - Lwd_curent</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/night-owl.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.9","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>LWD</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/2.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="spring-boot-starter-security：应用安全">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-03-09 00:21" pubdate>
        2023年3月9日 凌晨
      </time>
    </span>
  
</div>
<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      1.7k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      22
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">spring-boot-starter-security：应用安全</h1>
            
            <div class="markdown-body">
              <h2 id="spring-boot-starter-security：应用安全"><a href="#spring-boot-starter-security：应用安全" class="headerlink" title="spring-boot-starter-security：应用安全"></a>spring-boot-starter-security：应用安全</h2><p>在 <code>pom.xml</code> 中添加依赖 <code>spring-boot-starter-security</code></p>
<p>该依赖介绍：一般是企业在页面开发过程中安全管理所用的，Spring Boot权限框架，对开发者更友好的分布式权限验证框架，极大的提高验证效率</p>
<p>添加依赖后重新启动springboot并访问地址，会出现一个登录页面</p>
<blockquote>
<p>默认的用户名：<code>user</code></p>
<p>在 <code>idea</code> 控制台可以看到动态生成的密码 <code>Using generated security password:</code></p>
</blockquote>
<p><strong>但是通过修改 <code>Spring Security</code>，可以将该技术用于实现：更安全地判断用户登录等操作</strong></p>
<h3 id="改造Spring-Security"><a href="#改造Spring-Security" class="headerlink" title="改造Spring Security"></a>改造Spring Security</h3><h5 id="1-新建一个-service-impl-UserDetailsServiceImpl-类，继承自-security-的-UserDetailsService-接口"><a href="#1-新建一个-service-impl-UserDetailsServiceImpl-类，继承自-security-的-UserDetailsService-接口" class="headerlink" title="1. 新建一个 service.impl.UserDetailsServiceImpl 类，继承自 security 的 UserDetailsService 接口"></a><strong>1. 新建一个 <code>service.impl.UserDetailsServiceImpl</code> 类，继承自 <code>security</code> 的 <code>UserDetailsService</code> 接口</strong></h5><blockquote>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.lwd.backend.service.impl;<br><br><span class="hljs-keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDetailsServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDetailsService</span> </span>&#123;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p><strong>写完上述代码会爆红，因为继承接口后没有实现方法，需要用 <code>Alt + Enter</code> ，然后选择实现方法才能补全</strong></p>
<p><code>service.impl.UserDetailsServiceImpl</code> 类代码</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.lwd.backend.service.impl;<br><br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;<br><span class="hljs-keyword">import</span> com.lwd.backend.mapper.UserMapper;<br><span class="hljs-keyword">import</span> com.lwd.backend.pojo.User;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.security.core.userdetails.UserDetails;<br><span class="hljs-keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;<br><span class="hljs-keyword">import</span> org.springframework.security.core.userdetails.UsernameNotFoundException;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDetailsServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDetailsService</span> </span>&#123;<br><br><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">private</span> UserMapper userMapper;<br><br> <span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> UserDetails <span class="hljs-title">loadUserByUsername</span><span class="hljs-params">(String username)</span> <span class="hljs-keyword">throws</span> UsernameNotFoundException </span>&#123;<br><br>     <span class="hljs-comment">// 这里写User要看清楚是引用哪里的User！</span><br>  QueryWrapper&lt;User&gt; queryWrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br>     queryWrapper.eq(<span class="hljs-string">&quot;username&quot;</span>, username);<br>     <span class="hljs-comment">// 前端传回一个username。从数据库中查找是否存在一条记录的username等于前端传回的username</span><br>     User user = userMapper.selectOne(queryWrapper);<br>     <span class="hljs-keyword">if</span> (user == <span class="hljs-keyword">null</span>) &#123;<br>         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;用户不存在！&quot;</span>);<br>     &#125;<br>     <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br> &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>从该段代码中，我发现每个实现类的开头，都需要加一个注解，例如这里我加了@Service用于表示service层，不加的话，使用@Autowired就会报错。<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33286699/article/details/119204847">Conroller注解与RestController注解、Component注解</a></p>
<p>也可以使用万能的@Component来泛指各种类</p>
<p>该段代码，可以将前端获取的username与后端数据库相对比，若数据库中无该username，则抛出”用户不存在”。</p>
</blockquote>
<h5 id="2-新建一个-service-impl-utils-UserDetailsImpl-类，继承自-security-的-UserDetails-接口"><a href="#2-新建一个-service-impl-utils-UserDetailsImpl-类，继承自-security-的-UserDetails-接口" class="headerlink" title="2. 新建一个 service.impl.utils.UserDetailsImpl 类，继承自 security 的 UserDetails 接口"></a><strong>2. 新建一个 <code>service.impl.utils.UserDetailsImpl</code> 类，继承自 <code>security</code> 的 <code>UserDetails</code> 接口</strong></h5><blockquote>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.lwd.backend.service.impl.utils;<br><br><span class="hljs-keyword">import</span> org.springframework.security.core.userdetails.UserDetails;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDetailsImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDetails</span> </span>&#123;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p><strong>写完上述代码会爆红，因为继承接口后没有实现方法，需要用 <code>Alt + Enter</code> ，然后选择实现方法才能补全</strong></p>
<p>这个类可以定义用户的各种属性，在补全代码后，将以下几个属性设置为 <code>true</code></p>
<p><code>isEnabled</code>、<code>isCredentialsNonExpired</code>、<code>isAccountNonLocked</code>、<code>isAccountNonExpired</code></p>
<p>在类中添加/更改以下代码</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">private</span> User user; <span class="hljs-comment">// 这个User是pojo的</span><br><br><span class="hljs-meta">@Override</span><br> <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPassword</span><span class="hljs-params">()</span> </span>&#123;<br>     <span class="hljs-keyword">return</span> user.getPassword(); <br> &#125;<br><span class="hljs-meta">@Override</span><br> <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUsername</span><span class="hljs-params">()</span> </span>&#123;<br>     <span class="hljs-keyword">return</span> user.getUsername();<br> &#125;<br></code></pre></div></td></tr></table></figure>
</blockquote>
<h5 id="完成1，2两个类的初步编写后，我们需要将其连接。"><a href="#完成1，2两个类的初步编写后，我们需要将其连接。" class="headerlink" title="完成1，2两个类的初步编写后，我们需要将其连接。"></a>完成1，2两个类的初步编写后，我们需要将其连接。</h5><blockquote>
<p>也就是在  <code>service.impl.UserDetailsServiceImpl</code> 中，我们已经写了如果查询数据库找不到用户username时抛出异常”用户不存在”，但若用户存在的代码还没有编写完，所有更新一下 <code>UserDetailsServiceImpl</code> 类最后 <code>return</code> 返回的内容，而这个内容就是 <code>UserDetailsImpl</code> 类中实现的用户属性</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (user == <span class="hljs-keyword">null</span>) &#123;<br>         <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;用户不存在！&quot;</span>);<br>     &#125;<br>     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserDetailsImpl(user); <br><span class="hljs-comment">//将通过username在数据库中查到的用户信息，传入UserDetailsImpl中，从而跟赋予用户属性</span><br></code></pre></div></td></tr></table></figure>

<p>写完这段会发现 <code>UserDetailsImpl(user)</code> 爆红，因为这个 <code>user</code> 是由 <code>pojo</code> 的 <code>User</code> 类定义的，所以须在 <code>UserDetailsImpl</code> 类的开头，加上和 <code>User</code> 类一样的三个注解</p>
<p>(小部分代码)</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-comment">// 需添加上面三个注解</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDetailsImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserDetails</span> </span>&#123;<br></code></pre></div></td></tr></table></figure>
</blockquote>
<p>至此，便完成了 <code>Spring Security</code> 的一个改造：原先 <code>Spring Security</code> 是自己定义一个用户 <code>user</code>，和动态生成一串密码。但是现在，<code>Spring Security</code> 会根据用户输入的 <code>username</code> 和 <code>password</code> 去我们的数据库中查找，若查找成功，则会通过 <code>UserDetailsImpl</code> 类去给这个用户赋予一些属性。</p>
<p>不过这个修改只是对后端进行修改，而用户输入 <code>username</code> 和 <code>password</code> 时的前端界面，还是 <code>Spring Security</code> 自带的，当然我们也可以对前端进行修改，写一个我们自己的前端登录界面。</p>
<p>但是，此时我们再次运行SpringBoot，会发现还是无法登录，控制台报错：<code>There is no PasswordEncoder mapped for the id &quot;null&quot;</code> </p>
<p>我们可以看一下 <code>Spring Security</code> 的官方文档</p>
<figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciiarmor">The general format for a password is:<br> <br>&#123;id&#125;encodedPassword<br>Such that id is an identifier used to look up which PasswordEncoder should be used and encodedPassword is the original encoded password for the selected PasswordEncoder. The id must be at the beginning of the password, start with &#123; and end with &#125;. If the id cannot be found, the id will be null. For example, the following might be a list of passwords encoded using different id. All of the original passwords are &quot;password&quot;.<br> <br>&#123;bcrypt&#125;$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM&#x2F;BG <br>&#123;noop&#125;password <br>&#123;pbkdf2&#125;5d923b44a6d129f3ddf3e3c8d29412723dcbde72445e8ef6bf3b508fbf17fa4ed4d6b99ca763d8dc <br>&#123;scrypt&#125;$e0801$8bWJaSu2IKSn9Z9kM+TPXfOc&#x2F;9bdYSrN1oD9qfVThWEwdRTnO7re7Ei+fUZRJ68k9lTyuTeUp4of4g24hHnazw&#x3D;&#x3D;$OAOec05+bXxvuu&#x2F;1qZ6NUR+xQYvYv7BeL1QxwRpY5Pc&#x3D;  <br>&#123;sha256&#125;97cde38028ad898ebc02e690819fa220e88c62e0699403e94fff291cfffaf8410849f27605abcbc0<br></code></pre></div></td></tr></table></figure>

<p>这个错误是说：现如今 <code>Spring Security</code> 中密码的存储格式是 <code>&#123;id&#125;encodedPassword</code> </p>
<p>前面的 <code>id</code> 是加密方式，<code>id</code> 可以是 <code>bcrypt</code>、<code>sha256</code> 等，后面跟着的是加密后的密码</p>
<p>也就是说： <code>Spring Security</code> 拿到密码时，会首先查找被 <code>&#123;&#125;</code> 包起来的 <code>id</code>，从而来确定后面的密码是被怎么样加密的,如果找不到就认为id是null</p>
<p>而我们目前还没有任何加密方式，所以可以选择官方文档中提供的 <code>&#123;noop&#125;password</code> 格式来对数据库中的用户的password直接手动修改。</p>
<p><img src="/2023/03/09/spring-boot-starter-security%EF%BC%9A%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/1.gif" srcset="/img/loading.gif" lazyload></p>
<h3 id="实现密码加密"><a href="#实现密码加密" class="headerlink" title="实现密码加密"></a>实现密码加密</h3><p>我们要在 <code>controller.user.UserController</code> 类中，添加一个简易版的注册用户功能，并在用户输入密码时，将密码通过 <code>bcrypt</code> 加密，并将加密后的密码存到数据库中。</p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@GetMapping(&quot;/user/add/&#123;userId&#125;/&#123;username&#125;/&#123;password&#125;&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">addUser</span><span class="hljs-params">(</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@PathVariable</span> <span class="hljs-keyword">int</span> userId,</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@PathVariable</span> String username,</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@PathVariable</span> String password)</span> </span>&#123;<br>        PasswordEncoder passwordEncoder = <span class="hljs-keyword">new</span> BCryptPasswordEncoder();<br>        String encodePassword = passwordEncoder.encode(password);<br>        User user = <span class="hljs-keyword">new</span> User(userId, username, encodePassword);<br>        userMapper.insert(user);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;用户注册成功&quot;</span>;<br>    &#125;<br></code></pre></div></td></tr></table></figure>

<p>用户直接在url中给出 <code>userId</code>、<code>username</code>、<code>password</code>，之后，通过加密，将含有密码密文的用户信息新增到user表中，即为注册成功。</p>
<p>完成密码加密后，则需告诉 <code>Spring Security</code> 采用 <code>bcrypt</code> 进行密码解密</p>
<p><strong>新建一个 <code>config.SecurityConfig</code> 类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.lwd.backend.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;<br><span class="hljs-keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableWebSecurity</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecurityConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> PasswordEncoder <span class="hljs-title">passwordEncoder</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> BCryptPasswordEncoder();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>完成上述代码后，就相当于告诉 <code>Spring Security</code> 了，采用 <code>bcrypt</code> 进行密码解密。</p>
<p><img src="/2023/03/09/spring-boot-starter-security%EF%BC%9A%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/2.gif" srcset="/img/loading.gif" lazyload></p>
<p>虽然上述问题已解决，但存在一个bug，那就是必须要先有一个账号，才能注册新的账号。之后会修好这个bug的</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Java/">Java</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%90%8E%E7%AB%AF/">后端</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/03/09/SpringBoot%E5%90%84%E6%A8%A1%E5%9D%97%E9%80%BB%E8%BE%91/">
                        <span class="hidden-mobile">SpringBoot各模块逻辑</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
  <!-- 引用依赖 -->
<link rel="stylesheet" 
href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script>

<!-- 我使用的APlayer本体 -->
<div class="aplayer" 
data-id="6724136629" 
data-server="netease" 
data-type="playlist" 
data-fixed="true" 
data-autoplay="false" 
data-order="random" 
data-volume="0.55" 
data-theme="#cc543a" 
data-preload="auto" >
</div>
<!--如果将本体放在body里面导致页面加载出现问题，请尝试放到body体后面-->

</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<!--浏览器搞笑标题-->
<script type="text/javascript" src="\js\FunnyTitle.js"></script>

<script src="/live2d/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2d/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"display":{"position":"right","width":300,"height":600,"hOffset":-60,"vOffset":-140},"mobile":{"show":true},"model":{"scale":1.2,"jsonPath":"/live2d/assets/Yuri.model.json"},"log":false});</script></body>
</html>
